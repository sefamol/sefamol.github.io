---
layout: post
title: Burpsuite - SQL injection vulnerability in WHERE clause allowing retrieval of hidden data
date: 2024-12-10 21:50:00
description: Laboratorio introductorio a inyección SQL
tags: Burpsuite, Portswigger, pentesting, ciberseguridad, Web, Inyección SQL
categories: Seguridad Informática
thumbnail: assets/img/burp-logo.png
featured: true
---

# **Datos Generales**
- **Software**: Burpsuite Community 
- **Dificultad**: Fácil
- **Duracion**: 10 minutos
- **Observaciones**: Se realizo la inyección de manera simple desde la url.
- **CVSS 3.1**: AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L  **9.1 Crítico**

## **Reconocimiento**
- Dada la naturaleza del laboratorio se presento un solo endpoint **category** el cual se mostraba vulnerable a la inyección.

---

## **Explicación de la vulnerabilidad**

La vulnerabilidad afecta a una base de datos que no tiene consultas parametrizadas y/o no esta sanitizada, lo que permite la inyección de código en una petición.

Una consulta esperada a la base de datos tiene la siguiente forma:<br>

`...academy.net/filter?category=Corporate+gifts`

Y en la Base de Datos se ve de la siguiente manera:

`SELECT * FROM products WHERE category = 'Gifts' AND released = 1` <br>

en este sentido realizar la prueba de inyección SQL utilizando la prueba clasica **'or1=1--** donde:

- **'**: Se utiliza para terminar el valor esperado del campo category.
- **OR**: Operador lógico que permite ingresar una condición verdadera o no con la intención de evadir controles.
- **1=1**: Condición que siempre es verdadera.

---

## **Solución del laboratorio**

Podemos notar que existe un menu de busqueda que permite ingresar a categorias de los productos de la web

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/Burp-SQL-01-02.png" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
Notamos que ingresando por ese menu la web despliega la siguiente url

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/Burp-SQL-01-03.png" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

Insertamos el payload en la url de la siguiente manera:

```
https://0a2e006a04e7be4f8222664a00b10018.web-security-academy.net/filter?category=%27+or+1=1--
```
Dando como resultado la solución del laboratorio

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/Burp-SQL-01-01.png" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

---
## **Mitigación**

- **Realizar consultas parametrizadas**
Evitar la concatenación de entradas de usuario en las consultas.

- **Validación de entradas**
Asegurar que las entradas de usuario sean saneadas y validadas antes de procesarlas.

**URL del laboratorio:** https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data
