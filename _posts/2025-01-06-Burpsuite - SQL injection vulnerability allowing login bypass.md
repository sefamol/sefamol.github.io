---
layout: post
title: Burpsuite - SQL injection vulnerability allowing login bypass
date: 2025-01-06 22:30:00
description: Laboratorio introductorio a inyección SQL
tags: Burpsuite, Portswigger, pentesting, ciberseguridad, Web, Inyección SQL
categories: Seguridad Informática
thumbnail: assets/img/burp-logo.png
featured: false
---

# **Datos Generales**
- **Software**: Burpsuite Community 
- **Dificultad**: Fácil
- **Duracion**: 5 minutos
- **Observaciones**: Se realizo una inyección SQL simple al login de la aplicación
- **CVSS 3.1**: AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H  **9.8 Crítico**

## **Reconocimiento**
- Dada la naturaleza del laboratorio se presento un solo endpoint, el **login** de la aplciación

---

## **Explicación de la vulnerabilidad**

La vulnerabilidad afecta a una base de datos que no tiene consultas parametrizadas y/o no esta sanitizada, lo que permite la inyección de código en una petición.

Una consulta esperada a la base de datos tiene la siguiente forma:<br>

`...academy.net/filter?category=Corporate+gifts`

Y en la Base de Datos se ve de la siguiente manera:

`SELECT * FROM products WHERE category = 'Gifts' AND released = 1` <br>

en este sentido realizar la prueba de inyección SQL utilizando la prueba clasica **' --** donde:

- **'**: Se utiliza para terminar el valor esperado del campo category.
- **--**: Ingresa comentario

---

## **Solución del laboratorio**

La página de login presenta 2 campos de input para validar los datos de usuario **username** y **pasword** 

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/burpsuite-bypass-login101.png" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

Probamos realizar la inyección simple ```' --``` en el campo username

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/burpsuite-bypass-login102.png" class="img-fluid rounded z-depth-1" %}
    </div>
</div>


Dando como resultado la solución del laboratorio

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/burpsuite-bypass-login103.png" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

---
## **Mitigación**

- **Realizar consultas parametrizadas**
Evitar la concatenación de entradas de usuario en las consultas.

- **Validación de entradas**
Asegurar que las entradas de usuario sean saneadas y validadas antes de procesarlas.

**URL del laboratorio:** https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data
